import{b as _,c as q}from"./chunk-NID2KXD2.js";import{$a as U,A as b,Aa as m,Ab as T,Bb as z,Ja as v,Q as a,W as d,X as g,Xa as y,Y as h,ca as s,da as l,ia as c,ja as r,ka as i,la as u,mb as N,nb as V,ob as C,pb as x,ra as R,s as S,sb as P,ta as f,tb as E,ub as p,vb as L,wb as F,xb as A,yb as I,zb as w}from"./chunk-YKZVNGVC.js";var j=class e{constructor(o,n){this.router=o;this.accountService=n;console.log("LayoutComponent constructor"),this.accountService.userValue?this.router.navigate(["/"]):this.router.navigate(["/account/login"])}ngOnInit(){console.log("LayoutComponent ngOnInit")}static \u0275fac=function(n){return new(n||e)(d(C),d(_))};static \u0275cmp=g({type:e,selectors:[["ng-component"]],standalone:!1,decls:2,vars:0,consts:[[1,"container","col-md-6","offset-md-3","mt-5"]],template:function(n,t){n&1&&(r(0,"div",0),u(1,"router-outlet"),i())},dependencies:[V],encapsulation:2})};var Q=e=>({"is-invalid":e});function ee(e,o){e&1&&(r(0,"div"),m(1,"Username is required"),i())}function te(e,o){if(e&1&&(r(0,"div",7),s(1,ee,2,0,"div"),i()),e&2){let n=f();a(),l(n.f.username.errors.required?1:-1)}}function ie(e,o){e&1&&(r(0,"div"),m(1,"Password is required"),i())}function ne(e,o){if(e&1&&(r(0,"div",7),s(1,ie,2,0,"div"),i()),e&2){let n=f();a(),l(n.f.password.errors.required?1:-1)}}function oe(e,o){e&1&&u(0,"span",10)}var D=class e{constructor(o,n,t,O,X){this.formBuilder=o;this.route=n;this.router=t;this.accountService=O;this.alertService=X}form;loading=!1;submitted=!1;ngOnInit(){this.form=this.formBuilder.group({username:["",p.required],password:["",p.required]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.accountService.login(this.f.username.value,this.f.password.value).pipe(S()).subscribe({next:()=>{let o=this.route.snapshot.queryParams.returnUrl||"/";this.router.navigateByUrl(o)},error:o=>{this.alertService.error(o?.error?.message||"Login failed"),this.loading=!1}}))}static \u0275fac=function(n){return new(n||e)(d(T),d(N),d(C),d(_),d(q))};static \u0275cmp=g({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:11,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],[1,"spinner-border","spinner-border-sm","me-1"],["routerLink","../register",1,"btn","btn-link"]],template:function(n,t){n&1&&(r(0,"div",0)(1,"h4",1),m(2,"Login"),i(),r(3,"div",2)(4,"form",3),R("ngSubmit",function(){return t.onSubmit()}),r(5,"div",4)(6,"label",5),m(7,"Username"),i(),u(8,"input",6),s(9,te,2,1,"div",7),i(),r(10,"div",4)(11,"label",5),m(12,"Password"),i(),u(13,"input",8),s(14,ne,2,1,"div",7),i(),r(15,"div")(16,"button",9),s(17,oe,1,0,"span",10),m(18," Login "),i(),r(19,"a",11),m(20,"Register"),i()()()()()),n&2&&(a(4),c("formGroup",t.form),a(4),c("ngClass",v(7,Q,t.submitted&&t.f.username.errors)),a(),l(t.submitted&&t.f.username.errors?9:-1),a(4),c("ngClass",v(9,Q,t.submitted&&t.f.password.errors)),a(),l(t.submitted&&t.f.password.errors?14:-1),a(2),c("disabled",t.loading),a(),l(t.loading?17:-1))},dependencies:[y,A,E,L,F,I,w,x],encapsulation:2})};var B=e=>({"is-invalid":e});function re(e,o){e&1&&(r(0,"div"),m(1,"First Name is required"),i())}function ae(e,o){if(e&1&&(r(0,"div",7),s(1,re,2,0,"div"),i()),e&2){let n=f();a(),l(n.f.firstName.errors.required?1:-1)}}function me(e,o){e&1&&(r(0,"div"),m(1,"Last Name is required"),i())}function se(e,o){if(e&1&&(r(0,"div",7),s(1,me,2,0,"div"),i()),e&2){let n=f();a(),l(n.f.lastName.errors.required?1:-1)}}function le(e,o){e&1&&(r(0,"div"),m(1,"Username is required"),i())}function de(e,o){if(e&1&&(r(0,"div",7),s(1,le,2,0,"div"),i()),e&2){let n=f();a(),l(n.f.username.errors.required?1:-1)}}function ce(e,o){e&1&&(r(0,"div"),m(1,"Password is required"),i())}function ue(e,o){e&1&&(r(0,"div"),m(1,"Password must be at least 6 characters"),i())}function pe(e,o){if(e&1&&(r(0,"div",7),s(1,ce,2,0,"div"),s(2,ue,2,0,"div"),i()),e&2){let n=f();a(),l(n.f.password.errors.required?1:-1),a(),l(n.f.password.errors.minlength?2:-1)}}function fe(e,o){e&1&&u(0,"span",12)}var G=class e{constructor(o,n,t,O,X){this.formBuilder=o;this.route=n;this.router=t;this.accountService=O;this.alertService=X}form;loading=!1;submitted=!1;ngOnInit(){this.form=this.formBuilder.group({firstName:["",p.required],lastName:["",p.required],username:["",p.required],password:["",[p.required,p.minLength(6)]]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.accountService.register(this.form.value).pipe(S()).subscribe({next:()=>{this.alertService.success("Registration successful",{keepAfterRouteChange:!0}),this.router.navigate(["../login"],{relativeTo:this.route})},error:o=>{this.alertService.error(o?.error?.message||"Registration failed"),this.loading=!1}}))}static \u0275fac=function(n){return new(n||e)(d(T),d(N),d(C),d(_),d(q))};static \u0275cmp=g({type:e,selectors:[["ng-component"]],standalone:!1,decls:31,vars:19,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],[1,"spinner-border","spinner-border-sm","me-1"],["routerLink","../login",1,"btn","btn-link"]],template:function(n,t){n&1&&(r(0,"div",0)(1,"h4",1),m(2,"Register"),i(),r(3,"div",2)(4,"form",3),R("ngSubmit",function(){return t.onSubmit()}),r(5,"div",4)(6,"label",5),m(7,"First Name"),i(),u(8,"input",6),s(9,ae,2,1,"div",7),i(),r(10,"div",4)(11,"label",5),m(12,"Last Name"),i(),u(13,"input",8),s(14,se,2,1,"div",7),i(),r(15,"div",4)(16,"label",5),m(17,"Username"),i(),u(18,"input",9),s(19,de,2,1,"div",7),i(),r(20,"div",4)(21,"label",5),m(22,"Password"),i(),u(23,"input",10),s(24,pe,3,2,"div",7),i(),r(25,"div")(26,"button",11),s(27,fe,1,0,"span",12),m(28," Register "),i(),r(29,"a",13),m(30,"Cancel"),i()()()()()),n&2&&(a(4),c("formGroup",t.form),a(4),c("ngClass",v(11,B,t.submitted&&t.f.firstName.errors)),a(),l(t.submitted&&t.f.firstName.errors?9:-1),a(4),c("ngClass",v(13,B,t.submitted&&t.f.lastName.errors)),a(),l(t.submitted&&t.f.lastName.errors?14:-1),a(4),c("ngClass",v(15,B,t.submitted&&t.f.username.errors)),a(),l(t.submitted&&t.f.username.errors?19:-1),a(4),c("ngClass",v(17,B,t.submitted&&t.f.password.errors)),a(),l(t.submitted&&t.f.password.errors?24:-1),a(2),c("disabled",t.loading),a(),l(t.loading?27:-1))},dependencies:[y,A,E,L,F,I,w,x],encapsulation:2})};var ve=[{path:"",component:j,children:[{path:"login",title:"Login",component:D},{path:"register",title:"Register",component:G}]}],k=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=h({type:e});static \u0275inj=b({imports:[P.forChild(ve),P]})};var W=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=h({type:e});static \u0275inj=b({imports:[U,z,k]})};export{W as AccountModule};
