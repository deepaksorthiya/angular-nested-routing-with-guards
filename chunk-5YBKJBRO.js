import{C as n,a as i,b as h,bb as I,cb as p,d as g,e as b,eb as m,g as S,i as f,l as A,n as j,w as c,z as o}from"./chunk-2O6YKKCR.js";var s={production:!0,apiUrl:"http://localhost:4000/fake-api"};var U=class r{KEY="user";ROUTE_URL="redirectUrl";saveUser(t){sessionStorage.setItem(this.KEY,JSON.stringify(t))}loadUser(){let t=sessionStorage.getItem(this.KEY);return t?JSON.parse(t):null}clearUser(){sessionStorage.removeItem(this.KEY)}saveRedirectUrl(t){sessionStorage.setItem(this.ROUTE_URL,t)}loadRedirectUrl(){return sessionStorage.getItem(this.ROUTE_URL)}clearRedirectUrl(){sessionStorage.removeItem(this.ROUTE_URL)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var d=class r{constructor(t,e){this.http=t;this.authStorageService=e;this.authUserSubject=new b(this.authStorageService.loadUser()),this.authUser=this.authUserSubject.asObservable()}authUserSubject;authUser;login(t){let e=new p().set("username",t.username).set("password",t.password),u=new I().set("Content-Type","application/x-www-form-urlencoded");return this.http.post(`${s.apiUrl}/api/login`,e,{headers:u,withCredentials:!0}).pipe(c(l=>{this.setAuthenticatedUser(l)}))}logout(){return this.http.post(`${s.apiUrl}/api/logout`,null,{withCredentials:!0}).pipe(c(t=>{this.resetAuthenticatedUser()}))}getUserDetails(){return this.http.get(`${s.apiUrl}/api/user/me`,{withCredentials:!0}).pipe(c({next:t=>{this.setAuthenticatedUser(t)}})).pipe(j(t=>(console.error("ERROR from CatchERROR :: ",t),this.resetAuthenticatedUser(),S(null))))}setAuthenticatedUser(t){this.authStorageService.saveUser(t),this.authUserSubject.next(t)}resetAuthenticatedUser(){this.authStorageService.clearUser(),this.authUserSubject.next(null)}getUserSubject(){return this.authUserSubject}getUserObservable(){return this.authUser}currentUser(){return this.userValue()}isAuthenticated(){return this.userValue()!=null}userValue(){return this.authStorageService.loadUser()?this.authUserSubject.value:null}static \u0275fac=function(e){return new(e||r)(n(m),n(U))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var w=class r{constructor(t,e){this.authService=t;this.http=e}callFakeRestApi(){return this.http.get("https://jsonplaceholder.typicode.com/posts/1/comments")}getAllUsers(){return this.http.get("https://jsonplaceholder.typicode.com/users/")}getPostById(t){return this.http.get(`https://dummyjson.com/posts/${t}`)}getDateTimeAsync(t){let e=new p().set("offsetDateTime",t);return this.http.get("http://localhost:8080/offset",{params:e})}register(t){return this.http.post(`${s.apiUrl}/users/register`,t)}getAll(){return this.http.get(`${s.apiUrl}/users`)}getById(t){return this.http.get(`${s.apiUrl}/users/${t}`)}update(t,e){return this.http.put(`${s.apiUrl}/users/${t}`,e).pipe(f(u=>{let l=this.authService.currentUser();if(t==l?.id){let R=i(i({},l),e);this.authService.setAuthenticatedUser(R)}return u}))}delete(t){return this.http.delete(`${s.apiUrl}/users/${t}`).pipe(f(e=>{let u=this.authService.currentUser();return t==u?.id&&this.authService.logout(),e}))}static \u0275fac=function(e){return new(e||r)(n(d),n(m))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var a=class{id;type;message;autoClose;keepAfterRouteChange;fade;constructor(t){Object.assign(this,t)}};var O=class r{subject=new g;defaultId="default-alert";onAlert(t=this.defaultId){return this.subject.asObservable().pipe(A(e=>e&&e.id===t))}success(t,e){this.alert(new a(h(i({},e),{type:0,message:t})))}error(t,e){this.alert(new a(h(i({},e),{type:1,message:t})))}info(t,e){this.alert(new a(h(i({},e),{type:2,message:t})))}warn(t,e){this.alert(new a(h(i({},e),{type:3,message:t})))}alert(t){t.id=t.id||this.defaultId,this.subject.next(t)}clear(t=this.defaultId){this.subject.next(new a({id:t}))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a,U as b,d as c,w as d,O as e};
