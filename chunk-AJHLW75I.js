import{C as n,a as i,b as c,bb as A,cb as m,d as U,e as S,eb as f,g as b,i as v,l as j,n as I,w as h,z as o}from"./chunk-2O6YKKCR.js";var s={production:!0,apiUrl:"http://localhost:4000/fake-api"};var u=class r{KEY="user";ROUTE_URL="redirectUrl";saveUser(e){sessionStorage.setItem(this.KEY,JSON.stringify(e))}loadUser(){let e=sessionStorage.getItem(this.KEY);return e?JSON.parse(e):null}clearUser(){sessionStorage.removeItem(this.KEY)}saveRedirectUrl(e){sessionStorage.setItem(this.ROUTE_URL,e)}loadRedirectUrl(){return sessionStorage.getItem(this.ROUTE_URL)}clearRedirectUrl(){sessionStorage.removeItem(this.ROUTE_URL)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var d=class r{constructor(e,t){this.http=e;this.authStorageService=t;this.userSubject=new S(this.authStorageService.loadUser()),this.user=this.userSubject.asObservable()}userSubject;user;login(e){let t=new m().set("username",e.username).set("password",e.password),l=new A().set("Content-Type","application/x-www-form-urlencoded");return this.http.post(`${s.apiUrl}/api/login`,{},{headers:l,params:t}).pipe(h(p=>{this.setAuthenticatedUser(p)}))}logout(){return this.http.post(`${s.apiUrl}/api/logout`,null).pipe(h(e=>{this.resetAuthenticatedUser()}))}getUserDetails(){return this.http.get(`${s.apiUrl}/api/user/me`).pipe(h({next:e=>{this.setAuthenticatedUser(e)}})).pipe(I(e=>(console.error("ERROR from CatchERROR :: ",e),this.resetAuthenticatedUser(),b(null))))}setAuthenticatedUser(e){this.authStorageService.saveUser(e),this.userSubject.next(e)}resetAuthenticatedUser(){this.authStorageService.clearUser(),this.userSubject.next(null)}getUserSubject(){return this.userSubject}currentUser(){return this.userValue()}isAuthenticated(){return this.userValue()!=null}token(){return this.userValue()?.token??null}userValue(){return this.authStorageService.loadUser()?this.userSubject.value:null}static \u0275fac=function(t){return new(t||r)(n(f),n(u))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var R=class r{constructor(e,t,l){this.authService=e;this.authStorageService=t;this.http=l}callFakeRestApi(){return this.http.get("https://jsonplaceholder.typicode.com/posts/1/comments")}getAllUsers(){return this.http.get("https://jsonplaceholder.typicode.com/users/")}getPostById(e){return this.http.get(`https://dummyjson.com/posts/${e}`)}getDateTimeAsync(e){let t=new m().set("offsetDateTime",e);return this.http.get("http://localhost:8080/offset",{params:t})}register(e){return this.http.post(`${s.apiUrl}/users/register`,e)}getAll(){return this.http.get(`${s.apiUrl}/users`)}getById(e){return this.http.get(`${s.apiUrl}/users/${e}`)}update(e,t){return this.http.put(`${s.apiUrl}/users/${e}`,t).pipe(v(l=>{if(e==this.authService.currentUser()?.id){let p=i(i({},this.authService.currentUser),t);this.authStorageService.saveUser(p),this.authService.getUserSubject().next(p)}return l}))}delete(e){return this.http.delete(`${s.apiUrl}/users/${e}`).pipe(v(t=>(e==this.authService.currentUser()?.id&&this.authService.logout(),t)))}static \u0275fac=function(t){return new(t||r)(n(d),n(u),n(f))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var a=class{id;type;message;autoClose;keepAfterRouteChange;fade;constructor(e){Object.assign(this,e)}};var w=class r{subject=new U;defaultId="default-alert";onAlert(e=this.defaultId){return this.subject.asObservable().pipe(j(t=>t&&t.id===e))}success(e,t){this.alert(new a(c(i({},t),{type:0,message:e})))}error(e,t){this.alert(new a(c(i({},t),{type:1,message:e})))}info(e,t){this.alert(new a(c(i({},t),{type:2,message:e})))}warn(e,t){this.alert(new a(c(i({},t),{type:3,message:e})))}alert(e){e.id=e.id||this.defaultId,this.subject.next(e)}clear(e=this.defaultId){this.subject.next(new a({id:e}))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a,u as b,d as c,R as d,w as e};
