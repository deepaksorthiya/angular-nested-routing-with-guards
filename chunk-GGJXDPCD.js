import{b as L,c as Z}from"./chunk-33YODXDE.js";import{$a as O,A as h,Aa as a,Ab as X,Ba as v,Bb as Y,E as S,F as E,Ga as V,Ja as b,Q as r,S as u,T as C,U as y,Xa as B,ca as d,da as s,fa as M,ga as q,ha as j,ia as c,ja as o,ka as i,la as l,mb as G,nb as P,ob as $,pa as A,pb as w,ra as N,s as f,sb as k,ta as p,tb as z,ub as _,vb as H,wb as J,xb as K,yb as Q,zb as W}from"./chunk-GJL6GCMJ.js";var F=t=>({"is-invalid":t});function oe(t,n){t&1&&(o(0,"div"),a(1,"First Name is required"),i())}function re(t,n){if(t&1&&(o(0,"div",7),d(1,oe,2,0,"div"),i()),t&2){let e=p(2);r(),s(e.f.firstName.errors.required?1:-1)}}function ae(t,n){t&1&&(o(0,"div"),a(1,"Last Name is required"),i())}function de(t,n){if(t&1&&(o(0,"div",7),d(1,ae,2,0,"div"),i()),t&2){let e=p(2);r(),s(e.f.lastName.errors.required?1:-1)}}function se(t,n){t&1&&(o(0,"div"),a(1,"Username is required"),i())}function me(t,n){if(t&1&&(o(0,"div",7),d(1,se,2,0,"div"),i()),t&2){let e=p(2);r(),s(e.f.username.errors.required?1:-1)}}function le(t,n){t&1&&(o(0,"em"),a(1,"(Leave blank to keep the same password)"),i())}function ce(t,n){t&1&&(o(0,"div"),a(1,"Password is required"),i())}function pe(t,n){t&1&&(o(0,"div"),a(1,"Password must be at least 6 characters"),i())}function ue(t,n){if(t&1&&(o(0,"div",7),d(1,ce,2,0,"div"),d(2,pe,2,0,"div"),i()),t&2){let e=p(2);r(),s(e.f.password.errors.required?1:-1),r(),s(e.f.password.errors.minlength?2:-1)}}function fe(t,n){t&1&&l(0,"span",13)}function Ce(t,n){if(t&1){let e=A();o(0,"form",2),N("ngSubmit",function(){S(e);let g=p();return E(g.onSubmit())}),o(1,"div",3)(2,"div",4)(3,"label",5),a(4,"First Name"),i(),l(5,"input",6),d(6,re,2,1,"div",7),i(),o(7,"div",4)(8,"label",5),a(9,"Last Name"),i(),l(10,"input",8),d(11,de,2,1,"div",7),i()(),o(12,"div",3)(13,"div",4)(14,"label",5),a(15,"Username"),i(),l(16,"input",9),d(17,me,2,1,"div",7),i(),o(18,"div",4)(19,"label",5),a(20," Password "),d(21,le,2,0,"em"),i(),l(22,"input",10),d(23,ue,3,2,"div",7),i()(),o(24,"div",11)(25,"button",12),d(26,fe,1,0,"span",13),a(27," Save "),i(),o(28,"a",14),a(29,"Cancel"),i()()()}if(t&2){let e=p();c("formGroup",e.form),r(5),c("ngClass",b(12,F,e.submitted&&e.f.firstName.errors)),r(),s(e.submitted&&e.f.firstName.errors?6:-1),r(4),c("ngClass",b(14,F,e.submitted&&e.f.lastName.errors)),r(),s(e.submitted&&e.f.lastName.errors?11:-1),r(5),c("ngClass",b(16,F,e.submitted&&e.f.username.errors)),r(),s(e.submitted&&e.f.username.errors?17:-1),r(4),s(e.id?21:-1),r(),c("ngClass",b(18,F,e.submitted&&e.f.password.errors)),r(),s(e.submitted&&e.f.password.errors?23:-1),r(2),c("disabled",e.submitting),r(),s(e.submitting?26:-1)}}function ve(t,n){t&1&&(o(0,"div",1),l(1,"span",15),i())}var x=class t{constructor(n,e,m,g,R){this.formBuilder=n;this.route=e;this.router=m;this.accountService=g;this.alertService=R}form;id;title;loading=!1;submitting=!1;submitted=!1;ngOnInit(){this.id=this.route.snapshot.params.id,this.form=this.formBuilder.group({firstName:["",_.required],lastName:["",_.required],username:["",_.required],password:["",[_.minLength(6),...this.id?[]:[_.required]]]}),this.title="Add User",this.id&&(this.title="Edit User",this.loading=!0,this.accountService.getById(this.id).pipe(f()).subscribe(n=>{this.form.patchValue(n),this.loading=!1}))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.submitting=!0,this.saveUser().pipe(f()).subscribe({next:()=>{this.alertService.success("User saved",{keepAfterRouteChange:!0}),this.router.navigateByUrl("/users")},error:n=>{this.alertService.error(n),this.submitting=!1}}))}saveUser(){return this.id?this.accountService.update(this.id,this.form.value):this.accountService.register(this.form.value)}static \u0275fac=function(e){return new(e||t)(u(X),u(G),u($),u(L),u(Z))};static \u0275cmp=C({type:t,selectors:[["ng-component"]],standalone:!1,decls:4,vars:3,consts:[[3,"formGroup"],[1,"text-center","m-5"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"mb-3","col"],[1,"form-label"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"mb-3"],[1,"btn","btn-primary",3,"disabled"],[1,"spinner-border","spinner-border-sm","me-1"],["routerLink","/users",1,"btn","btn-link"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(e,m){e&1&&(o(0,"h1"),a(1),i(),d(2,Ce,30,20,"form",0),d(3,ve,2,0,"div",1)),e&2&&(r(),v(m.title),r(),s(m.loading?-1:2),r(),s(m.loading?3:-1))},dependencies:[B,K,z,H,J,Q,W,w],encapsulation:2})};var T=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["ng-component"]],standalone:!1,decls:3,vars:0,consts:[[1,"p-4"],[1,"container"]],template:function(e,m){e&1&&(o(0,"div",0)(1,"div",1),l(2,"router-outlet"),i()())},dependencies:[P],encapsulation:2})};function _e(t,n){t&1&&l(0,"span",7)}function be(t,n){t&1&&(o(0,"span"),a(1,"Delete"),i())}function xe(t,n){if(t&1){let e=A();o(0,"tr")(1,"td"),a(2),i(),o(3,"td"),a(4),i(),o(5,"td"),a(6),i(),o(7,"td",4)(8,"a",5),a(9,"Edit"),i(),o(10,"button",6),N("click",function(){let g=S(e).$implicit,R=p();return E(R.deleteUser(g.id))}),d(11,_e,1,0,"span",7),d(12,be,2,0,"span"),i()()()}if(t&2){let e=n.$implicit;r(2),v(e.firstName),r(2),v(e.lastName),r(2),v(e.username),r(2),c("routerLink",V("edit/",e.id)),r(2),c("disabled",e.isDeleting),r(),s(e.isDeleting?11:-1),r(),s(e.isDeleting?-1:12)}}function ge(t,n){t&1&&(o(0,"tr")(1,"td",8),l(2,"span",9),i()())}var U=class t{constructor(n){this.accountService=n}users;ngOnInit(){this.accountService.getAll().pipe(f()).subscribe(n=>this.users=n)}deleteUser(n){let e=this.users.find(m=>m.id===n);e.isDeleting=!0,this.accountService.delete(n).pipe(f()).subscribe(()=>this.users=this.users.filter(m=>m.id!==n))}static \u0275fac=function(e){return new(e||t)(u(L))};static \u0275cmp=C({type:t,selectors:[["ng-component"]],standalone:!1,decls:18,vars:1,consts:[["routerLink","add",1,"btn","btn-sm","btn-success","mb-2"],[1,"table","table-striped"],[2,"width","30%"],[2,"width","10%"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-primary","me-1",3,"routerLink"],[1,"btn","btn-sm","btn-danger","btn-delete-user",3,"click","disabled"],[1,"spinner-border","spinner-border-sm"],["colspan","4",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(e,m){e&1&&(o(0,"h1"),a(1,"Users"),i(),o(2,"a",0),a(3,"Add User"),i(),o(4,"table",1)(5,"thead")(6,"tr")(7,"th",2),a(8,"First Name"),i(),o(9,"th",2),a(10,"Last Name"),i(),o(11,"th",2),a(12,"Username"),i(),l(13,"th",3),i()(),o(14,"tbody"),q(15,xe,13,8,"tr",null,M),d(17,ge,3,0,"tr"),i()()),e&2&&(r(15),j(m.users),r(2),s(m.users?-1:17))},dependencies:[w],encapsulation:2})};var he=[{path:"",component:T,children:[{path:"",title:"All Users",component:U},{path:"add",title:"Add User",component:x},{path:"edit/:id",title:"Edit User",component:x}]}],D=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=y({type:t});static \u0275inj=h({imports:[k.forChild(he),k]})};var ie=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=y({type:t});static \u0275inj=h({imports:[O,Y,D]})};export{ie as UsersModule};
