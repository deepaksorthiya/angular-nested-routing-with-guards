import{b as J,c as N,d as x,e as q}from"./chunk-5YBKJBRO.js";import{$a as z,A as S,Aa as m,Ab as w,Bb as I,Cb as T,D as P,Db as K,Ja as v,Q as a,W as d,X as C,Xa as h,Y as _,ca as s,da as l,ia as c,ja as o,ka as n,la as u,ob as R,pb as H,qb as g,ra as b,rb as y,s as V,ta as f,ub as U,vb as A,wb as p,xb as E,yb as L,zb as F}from"./chunk-2O6YKKCR.js";var Q=(e,r)=>{let i=P(N),t=P(g);return i.isAuthenticated()?(t.navigate(["/"]),!1):!0};var j=class e{constructor(r,i,t){this.route=r;this.router=i;this.accountService=t;console.log("LayoutComponent constructor")}ngOnInit(){console.log("LayoutComponent ngOnInit"),console.log(this.route)}static \u0275fac=function(i){return new(i||e)(d(R),d(g),d(x))};static \u0275cmp=C({type:e,selectors:[["ng-component"]],standalone:!1,decls:2,vars:0,consts:[[1,"container","col-md-6","offset-md-3","mt-5"]],template:function(i,t){i&1&&(o(0,"div",0),u(1,"router-outlet"),n())},dependencies:[H],encapsulation:2})};var Y=e=>({"is-invalid":e});function oe(e,r){e&1&&(o(0,"div"),m(1,"Username is required"),n())}function re(e,r){if(e&1&&(o(0,"div",7),s(1,oe,2,0,"div"),n()),e&2){let i=f();a(),l(i.f.username.errors.required?1:-1)}}function ae(e,r){e&1&&(o(0,"div"),m(1,"Password is required"),n())}function me(e,r){if(e&1&&(o(0,"div",7),s(1,ae,2,0,"div"),n()),e&2){let i=f();a(),l(i.f.password.errors.required?1:-1)}}function se(e,r){e&1&&u(0,"span",10)}var D=class e{constructor(r,i,t,O,$){this.formBuilder=r;this.router=i;this.authService=t;this.authStorageService=O;this.alertService=$}form;loading=!1;submitted=!1;ngOnInit(){this.form=this.formBuilder.group({username:["user",p.required],password:["password",p.required]})}get f(){return this.form.controls}onSubmit(){if(this.submitted=!0,this.alertService.clear(),this.form.invalid)return;let r={username:this.f.username.value,password:this.f.password.value};this.loading=!0,this.authService.login(r).subscribe({next:i=>{console.log("Login Successful:",i);let t=this.authStorageService.loadRedirectUrl()||"/";this.authStorageService.clearRedirectUrl(),this.router.navigateByUrl(t)},error:i=>{this.alertService.error(i?.error?.detail||"Login failed"),this.loading=!1}})}static \u0275fac=function(i){return new(i||e)(d(T),d(g),d(N),d(J),d(q))};static \u0275cmp=C({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:11,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],[1,"spinner-border","spinner-border-sm","me-1"],["routerLink","../register",1,"btn","btn-link"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"h4",1),m(2,"Login"),n(),o(3,"div",2)(4,"form",3),b("ngSubmit",function(){return t.onSubmit()}),o(5,"div",4)(6,"label",5),m(7,"Username"),n(),u(8,"input",6),s(9,re,2,1,"div",7),n(),o(10,"div",4)(11,"label",5),m(12,"Password"),n(),u(13,"input",8),s(14,me,2,1,"div",7),n(),o(15,"div")(16,"button",9),s(17,se,1,0,"span",10),m(18," Login "),n(),o(19,"a",11),m(20,"Register"),n()()()()()),i&2&&(a(4),c("formGroup",t.form),a(4),c("ngClass",v(7,Y,t.submitted&&t.f.username.errors)),a(),l(t.submitted&&t.f.username.errors?9:-1),a(4),c("ngClass",v(9,Y,t.submitted&&t.f.password.errors)),a(),l(t.submitted&&t.f.password.errors?14:-1),a(2),c("disabled",t.loading),a(),l(t.loading?17:-1))},dependencies:[h,F,A,E,L,w,I,y],encapsulation:2})};var B=e=>({"is-invalid":e});function le(e,r){e&1&&(o(0,"div"),m(1,"First Name is required"),n())}function de(e,r){if(e&1&&(o(0,"div",7),s(1,le,2,0,"div"),n()),e&2){let i=f();a(),l(i.f.firstName.errors.required?1:-1)}}function ce(e,r){e&1&&(o(0,"div"),m(1,"Last Name is required"),n())}function ue(e,r){if(e&1&&(o(0,"div",7),s(1,ce,2,0,"div"),n()),e&2){let i=f();a(),l(i.f.lastName.errors.required?1:-1)}}function pe(e,r){e&1&&(o(0,"div"),m(1,"Username is required"),n())}function fe(e,r){if(e&1&&(o(0,"div",7),s(1,pe,2,0,"div"),n()),e&2){let i=f();a(),l(i.f.username.errors.required?1:-1)}}function ve(e,r){e&1&&(o(0,"div"),m(1,"Password is required"),n())}function ge(e,r){e&1&&(o(0,"div"),m(1,"Password must be at least 6 characters"),n())}function Ce(e,r){if(e&1&&(o(0,"div",7),s(1,ve,2,0,"div"),s(2,ge,2,0,"div"),n()),e&2){let i=f();a(),l(i.f.password.errors.required?1:-1),a(),l(i.f.password.errors.minlength?2:-1)}}function Se(e,r){e&1&&u(0,"span",12)}var G=class e{constructor(r,i,t,O,$){this.formBuilder=r;this.route=i;this.router=t;this.accountService=O;this.alertService=$}form;loading=!1;submitted=!1;ngOnInit(){this.form=this.formBuilder.group({firstName:["",p.required],lastName:["",p.required],username:["",p.required],password:["",[p.required,p.minLength(6)]]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.accountService.register(this.form.value).pipe(V()).subscribe({next:()=>{this.alertService.success("Registration successful",{keepAfterRouteChange:!0}),this.router.navigate(["../login"],{relativeTo:this.route})},error:r=>{this.alertService.error(r?.error?.message||"Registration failed"),this.loading=!1}}))}static \u0275fac=function(i){return new(i||e)(d(T),d(R),d(g),d(x),d(q))};static \u0275cmp=C({type:e,selectors:[["ng-component"]],standalone:!1,decls:31,vars:19,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],[1,"spinner-border","spinner-border-sm","me-1"],["routerLink","../login",1,"btn","btn-link"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"h4",1),m(2,"Register"),n(),o(3,"div",2)(4,"form",3),b("ngSubmit",function(){return t.onSubmit()}),o(5,"div",4)(6,"label",5),m(7,"First Name"),n(),u(8,"input",6),s(9,de,2,1,"div",7),n(),o(10,"div",4)(11,"label",5),m(12,"Last Name"),n(),u(13,"input",8),s(14,ue,2,1,"div",7),n(),o(15,"div",4)(16,"label",5),m(17,"Username"),n(),u(18,"input",9),s(19,fe,2,1,"div",7),n(),o(20,"div",4)(21,"label",5),m(22,"Password"),n(),u(23,"input",10),s(24,Ce,3,2,"div",7),n(),o(25,"div")(26,"button",11),s(27,Se,1,0,"span",12),m(28," Register "),n(),o(29,"a",13),m(30,"Cancel"),n()()()()()),i&2&&(a(4),c("formGroup",t.form),a(4),c("ngClass",v(11,B,t.submitted&&t.f.firstName.errors)),a(),l(t.submitted&&t.f.firstName.errors?9:-1),a(4),c("ngClass",v(13,B,t.submitted&&t.f.lastName.errors)),a(),l(t.submitted&&t.f.lastName.errors?14:-1),a(4),c("ngClass",v(15,B,t.submitted&&t.f.username.errors)),a(),l(t.submitted&&t.f.username.errors?19:-1),a(4),c("ngClass",v(17,B,t.submitted&&t.f.password.errors)),a(),l(t.submitted&&t.f.password.errors?24:-1),a(2),c("disabled",t.loading),a(),l(t.loading?27:-1))},dependencies:[h,F,A,E,L,w,I,y],encapsulation:2})};var _e=[{path:"",component:j,canActivate:[Q],children:[{path:"login",title:"Login",component:D},{path:"register",title:"Register",component:G}]}],k=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=_({type:e});static \u0275inj=S({imports:[U.forChild(_e),U]})};var Z=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=_({type:e});static \u0275inj=S({imports:[z,K,k]})};export{Z as AccountModule};
